import{u as A,r as n,a,j as e}from"./index-CpGjGsyF.js";const W=()=>{const{user:I}=A(),[h,b]=n.useState([]),[i,f]=n.useState({}),[y,j]=n.useState(!0),[T,m]=n.useState(null),[p,c]=n.useState(""),[x,g]=n.useState(""),[r,v]=n.useState("all");n.useEffect(()=>{l(),d()},[r]);const l=async()=>{try{const t=await a.get("/api/fraud/alerts/",{params:r!=="all"?{status:r}:{}});b(t.data)}catch(t){console.error("Error fetching alerts:",t)}finally{j(!1)}},d=async()=>{try{const t=await a.get("/api/fraud/alerts/dashboard_stats/");f(t.data)}catch(t){console.error("Error fetching stats:",t)}},w=async t=>{try{await a.post(`/api/fraud/alerts/${t}/assign_to_me/`),l()}catch(s){console.error("Error assigning alert:",s)}},S=async t=>{try{await a.post(`/api/fraud/alerts/${t}/resolve/`,{resolution_notes:p,action_taken:x}),m(null),c(""),g(""),l(),d()}catch(s){console.error("Error resolving alert:",s)}},R=async(t,s,o)=>{try{await a.post(`/api/fraud/alerts/${t}/escalate/`,{escalated_to:s,escalation_reason:o}),l(),d()}catch(z){console.error("Error escalating alert:",z)}},k=t=>{switch(t){case"critical":return"bg-red-500";case"high":return"bg-orange-500";case"medium":return"bg-yellow-500";case"low":return"bg-blue-500";default:return"bg-gray-500"}},_=t=>{switch(t){case"new":return"bg-red-100 text-red-800";case"investigating":return"bg-yellow-100 text-yellow-800";case"resolved":return"bg-green-100 text-green-800";case"escalated":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},u=h.filter(t=>r==="all"||t.status===r);return y?e.jsx("div",{className:"flex justify-center items-center h-64",children:"Loading..."}):e.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"24px"},children:[e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx("h1",{style:{fontSize:"28px",fontWeight:"bold",marginBottom:"8px",color:"#1e293b"},children:"Fraud Detection Dashboard"}),e.jsx("p",{style:{color:"#64748b"},children:"Monitor and manage suspicious transaction alerts"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"16px",marginBottom:"24px"},children:[e.jsx("div",{style:{background:"white",padding:"20px",borderRadius:"12px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",border:"1px solid #e2e8f0"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx("div",{style:{width:"40px",height:"40px",background:"#fee2e2",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",marginRight:"12px"},children:"‚ö†Ô∏è"}),e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"24px",fontWeight:"bold",color:"#1e293b"},children:i.new_alerts||0}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b"},children:"New Alerts"})]})]})}),e.jsx("div",{style:{background:"white",padding:"20px",borderRadius:"12px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",border:"1px solid #e2e8f0"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx("div",{style:{width:"40px",height:"40px",background:"#fef3c7",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",marginRight:"12px"},children:"üïê"}),e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"24px",fontWeight:"bold",color:"#1e293b"},children:i.investigating||0}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b"},children:"Investigating"})]})]})}),e.jsx("div",{style:{background:"white",padding:"20px",borderRadius:"12px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",border:"1px solid #e2e8f0"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx("div",{style:{width:"40px",height:"40px",background:"#d1fae5",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",marginRight:"12px"},children:"‚úÖ"}),e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"24px",fontWeight:"bold",color:"#1e293b"},children:i.resolved||0}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b"},children:"Resolved"})]})]})}),e.jsx("div",{style:{background:"white",padding:"20px",borderRadius:"12px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",border:"1px solid #e2e8f0"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx("div",{style:{width:"40px",height:"40px",background:"#e9d5ff",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",marginRight:"12px"},children:"üëÅÔ∏è"}),e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"24px",fontWeight:"bold",color:"#1e293b"},children:i.critical_alerts||0}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b"},children:"Critical"})]})]})})]}),e.jsx("div",{style:{display:"flex",gap:"4px",marginBottom:"24px",background:"#f1f5f9",borderRadius:"12px",padding:"4px"},children:[{value:"all",label:`All (${i.total_alerts||0})`},{value:"new",label:`New (${i.new_alerts||0})`},{value:"investigating",label:`Investigating (${i.investigating||0})`},{value:"resolved",label:`Resolved (${i.resolved||0})`},{value:"escalated",label:`Escalated (${i.escalated||0})`}].map(t=>e.jsx("button",{onClick:()=>v(t.value),style:{flex:1,padding:"12px 16px",background:r===t.value?"white":"transparent",border:"none",borderRadius:"8px",color:r===t.value?"#1e293b":"#64748b",fontWeight:r===t.value?"600":"500",cursor:"pointer",boxShadow:r===t.value?"0 1px 3px rgba(0,0,0,0.1)":"none"},children:t.label},t.value))}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[u.map(t=>e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",border:"1px solid #e2e8f0",transition:"box-shadow 0.2s"},onMouseEnter:s=>s.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.15)",onMouseLeave:s=>s.currentTarget.style.boxShadow="0 1px 3px rgba(0,0,0,0.1)",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"16px"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[e.jsx("span",{style:{padding:"4px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:"600",color:"white",background:k(t.priority).replace("bg-","").replace("-500","")},children:t.priority.toUpperCase()}),e.jsx("span",{style:{padding:"4px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:"600",...(()=>{const s=_(t.status).split(" ");return{background:s[0].replace("bg-",""),color:s[1].replace("text-","").replace("-800","")}})()},children:t.status}),e.jsxs("span",{style:{fontSize:"14px",color:"#64748b"},children:["Score: ",t.fraud_score]})]}),e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"4px",color:"#1e293b"},children:t.title}),e.jsx("p",{style:{color:"#64748b",marginBottom:"8px"},children:t.description}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px",fontSize:"14px",color:"#64748b"},children:[e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"4px"},children:["üë§ ",t.transaction_details?.member_name||"Unknown"]}),e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"4px"},children:["üí∞ $",t.transaction_details?.amount||0]}),e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"4px"},children:["üìÖ ",new Date(t.created_at).toLocaleDateString()]})]})]}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[t.status==="new"&&e.jsx("button",{onClick:()=>w(t.id),style:{padding:"8px 16px",border:"1px solid #d1d5db",borderRadius:"6px",background:"white",color:"#374151",fontSize:"14px",fontWeight:"500",cursor:"pointer"},children:"Assign to Me"}),t.status==="investigating"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>{const s=prompt("Action Taken (approved/blocked/investigated/false_positive):",x);if(s){g(s);const o=prompt("Resolution Notes:",p);o!==null&&(c(o),S(t.id))}},style:{padding:"8px 16px",border:"1px solid #d1d5db",borderRadius:"6px",background:"white",color:"#374151",fontSize:"14px",fontWeight:"500",cursor:"pointer"},children:"Resolve"}),e.jsx("button",{onClick:()=>R(t.id,"manager","Requires manager review"),style:{padding:"8px 16px",border:"1px solid #d1d5db",borderRadius:"6px",background:"white",color:"#374151",fontSize:"14px",fontWeight:"500",cursor:"pointer"},children:"Escalate"})]})]})]}),e.jsxs("div",{style:{borderTop:"1px solid #e2e8f0",paddingTop:"16px"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",fontSize:"14px"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Transaction ID:"})," ",t.transaction_details?.id||"N/A"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Account:"})," ",t.account_details?.account_number||"N/A"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Type:"})," ",t.transaction_details?.type||"N/A"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Amount:"})," $",t.transaction_details?.amount||0]})]}),t.rule_details&&e.jsxs("div",{style:{marginTop:"16px"},children:[e.jsx("strong",{children:"Triggered Rules:"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"4px",marginTop:"4px"},children:t.rule_details.map((s,o)=>e.jsx("span",{style:{padding:"2px 8px",border:"1px solid #d1d5db",borderRadius:"12px",fontSize:"12px",background:"#f9fafb"},children:s.name},o))})]})]})]},t.id)),u.length===0&&e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"48px",textAlign:"center",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",border:"1px solid #e2e8f0"},children:[e.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"‚ö†Ô∏è"}),e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"8px",color:"#1e293b"},children:"No alerts found"}),e.jsx("p",{style:{color:"#64748b"},children:r==="all"?"There are currently no fraud alerts to review.":`No ${r} alerts found.`})]})]})]})};export{W as default};
