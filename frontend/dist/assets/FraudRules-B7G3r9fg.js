import{u as C,r as n,a as c,j as e}from"./index-CpGjGsyF.js";const B=()=>{const{user:o}=C(),[s,p]=n.useState([]),[a,g]=n.useState([]),[r,i]=n.useState(!0),[y,d]=n.useState(!1),[b,f]=n.useState(null),[x,u]=n.useState({name:"",description:"",rule_type:"",severity:"medium",field:"",operator:"",value:"",additional_conditions:{},is_active:!0,auto_block:!1,require_approval:!1,escalation_threshold:0});n.useEffect(()=>{v(),h()},[]);const v=async()=>{try{const t=await c.get("/api/fraud/rules/");p(t.data)}catch(t){console.error("Error fetching rules:",t)}finally{i(!1)}},h=async()=>{try{const t=await c.get("/api/fraud/rules/active_rules/");g(t.data)}catch(t){console.error("Error fetching active rules:",t)}},_=async()=>{try{const t=await c.post("/api/fraud/rules/",x);p([...s,t.data]),d(!1),m(),h()}catch(t){console.error("Error creating rule:",t)}},S=async()=>{try{const t=await c.put(`/api/fraud/rules/${b.id}/`,x);p(s.map(l=>l.id===b.id?t.data:l)),f(null),m(),h()}catch(t){console.error("Error updating rule:",t)}},k=async t=>{try{await c.post(`/api/fraud/rules/${t}/toggle_active/`),v(),h()}catch(l){console.error("Error toggling rule:",l)}},m=()=>{u({name:"",description:"",rule_type:"",severity:"medium",field:"",operator:"",value:"",additional_conditions:{},is_active:!0,auto_block:!1,require_approval:!1,escalation_threshold:0})},R=t=>{f(t),u({name:t.name,description:t.description,rule_type:t.rule_type,severity:t.severity,field:t.field,operator:t.operator,value:t.value,additional_conditions:t.additional_conditions||{},is_active:t.is_active,auto_block:t.auto_block,require_approval:t.require_approval,escalation_threshold:t.escalation_threshold})},w=t=>{switch(t){case"critical":return"bg-red-500";case"high":return"bg-orange-500";case"medium":return"bg-yellow-500";case"low":return"bg-blue-500";default:return"bg-gray-500"}},z=t=>{switch(t){case"amount_threshold":return"ðŸ’°";case"velocity_check":return"âš¡";case"unusual_pattern":return"ðŸ”";case"location_anomaly":return"ðŸ“";case"time_based":return"â°";case"account_behavior":return"ðŸ‘¤";default:return"âš™ï¸"}};return r?e.jsx("div",{className:"flex justify-center items-center h-64",children:"Loading..."}):e.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"24px"},children:[e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx("h1",{style:{fontSize:"28px",fontWeight:"bold",marginBottom:"8px",color:"#1e293b"},children:"Fraud Detection Rules"}),e.jsx("p",{style:{color:"#64748b"},children:"Configure and manage fraud detection rules"})]}),e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",marginBottom:"24px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",border:"1px solid #e2e8f0"},children:[e.jsx("h2",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px",color:"#1e293b"},children:"ðŸ›¡ï¸ Active Rules Summary"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:[e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#16a34a"},children:a.length}),e.jsx("div",{style:{fontSize:"14px",color:"#64748b"},children:"Active Rules"})]}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#dc2626"},children:a.filter(t=>t.severity==="critical").length}),e.jsx("div",{style:{fontSize:"14px",color:"#64748b"},children:"Critical Rules"})]}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#ea580c"},children:a.filter(t=>t.auto_block).length}),e.jsx("div",{style:{fontSize:"14px",color:"#64748b"},children:"Auto-Block Rules"})]}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#2563eb"},children:a.filter(t=>t.require_approval).length}),e.jsx("div",{style:{fontSize:"14px",color:"#64748b"},children:"Approval Required"})]})]})]}),e.jsx("div",{style:{marginBottom:"24px"},children:e.jsx("button",{onClick:()=>d(!0),style:{padding:"12px 24px",background:"#1e40af",color:"white",border:"none",borderRadius:"8px",fontSize:"16px",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},children:"âž• Create New Rule"})}),y&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",maxWidth:"600px",width:"90%",maxHeight:"80vh",overflowY:"auto"},children:[e.jsx("h2",{style:{fontSize:"20px",fontWeight:"600",marginBottom:"16px",color:"#1e293b"},children:"Create Fraud Detection Rule"}),e.jsx(j,{formData:x,setFormData:u,onSubmit:_,onCancel:()=>d(!1)})]})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[s.map(t=>e.jsx("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",border:"1px solid #e2e8f0",transition:"box-shadow 0.2s"},onMouseEnter:l=>l.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.15)",onMouseLeave:l=>l.currentTarget.style.boxShadow="0 1px 3px rgba(0,0,0,0.1)",children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"16px"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[e.jsx("span",{style:{fontSize:"24px"},children:z(t.rule_type)}),e.jsx("span",{style:{padding:"4px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:"600",color:"white",background:w(t.severity).replace("bg-","").replace("-500","")},children:t.severity.toUpperCase()}),e.jsx("span",{style:{padding:"4px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:"600",background:t.is_active?"#dbeafe":"#f3f4f6",color:t.is_active?"#1e40af":"#374151"},children:t.is_active?"Active":"Inactive"}),t.auto_block&&e.jsx("span",{style:{padding:"4px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:"600",background:"#fee2e2",color:"#dc2626"},children:"Auto-Block"}),t.require_approval&&e.jsx("span",{style:{padding:"4px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:"600",border:"1px solid #d1d5db",background:"white"},children:"Approval Required"})]}),e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"4px",color:"#1e293b"},children:t.name}),e.jsx("p",{style:{color:"#64748b",marginBottom:"8px"},children:t.description}),e.jsxs("div",{style:{fontSize:"14px",color:"#64748b"},children:[e.jsx("strong",{children:"Condition:"})," ",t.field," ",t.operator," ",t.value]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px",fontSize:"14px",color:"#64748b",marginTop:"8px"},children:[e.jsxs("span",{children:["Triggered: ",t.trigger_count," times"]}),e.jsxs("span",{children:["False Positives: ",t.false_positive_count]}),t.last_triggered&&e.jsxs("span",{children:["Last triggered: ",new Date(t.last_triggered).toLocaleDateString()]})]})]}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsx("button",{onClick:()=>R(t),style:{padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",background:"white",cursor:"pointer"},children:"âœï¸"}),e.jsx("button",{onClick:()=>k(t.id),style:{padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",background:"white",cursor:"pointer"},children:t.is_active?"ðŸŸ¢":"âšª"})]})]})},t.id)),s.length===0&&e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"48px",textAlign:"center",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",border:"1px solid #e2e8f0"},children:[e.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"ðŸ›¡ï¸"}),e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"8px",color:"#1e293b"},children:"No rules configured"}),e.jsx("p",{style:{color:"#64748b",marginBottom:"16px"},children:"Create your first fraud detection rule to start monitoring transactions."}),e.jsx("button",{onClick:()=>d(!0),style:{padding:"12px 24px",background:"#1e40af",color:"white",border:"none",borderRadius:"8px",fontSize:"16px",fontWeight:"500",cursor:"pointer"},children:"âž• Create First Rule"})]})]}),b&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",maxWidth:"600px",width:"90%",maxHeight:"80vh",overflowY:"auto"},children:[e.jsx("h2",{style:{fontSize:"20px",fontWeight:"600",marginBottom:"16px",color:"#1e293b"},children:"Edit Fraud Detection Rule"}),e.jsx(j,{formData:x,setFormData:u,onSubmit:S,onCancel:()=>f(null)})]})})]})},j=({formData:o,setFormData:s,onSubmit:p,onCancel:a})=>{const g=i=>{i.preventDefault(),p()},r=(i,y)=>{s(d=>({...d,[i]:y}))};return e.jsxs("form",{onSubmit:g,style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"16px"},children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",style:{display:"block",marginBottom:"4px",fontSize:"14px",fontWeight:"500",color:"#374151"},children:"Rule Name"}),e.jsx("input",{id:"name",type:"text",value:o.name,onChange:i=>r("name",i.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px"},required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"rule_type",style:{display:"block",marginBottom:"4px",fontSize:"14px",fontWeight:"500",color:"#374151"},children:"Rule Type"}),e.jsxs("select",{id:"rule_type",value:o.rule_type,onChange:i=>r("rule_type",i.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",background:"white"},children:[e.jsx("option",{value:"",children:"Select rule type"}),e.jsx("option",{value:"amount_threshold",children:"Amount Threshold"}),e.jsx("option",{value:"velocity_check",children:"Velocity Check"}),e.jsx("option",{value:"unusual_pattern",children:"Unusual Pattern"}),e.jsx("option",{value:"location_anomaly",children:"Location Anomaly"}),e.jsx("option",{value:"time_based",children:"Time-Based Rule"}),e.jsx("option",{value:"account_behavior",children:"Account Behavior"}),e.jsx("option",{value:"custom",children:"Custom Rule"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",style:{display:"block",marginBottom:"4px",fontSize:"14px",fontWeight:"500",color:"#374151"},children:"Description"}),e.jsx("textarea",{id:"description",value:o.description,onChange:i=>r("description",i.target.value),rows:3,style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",resize:"vertical"}})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"severity",style:{display:"block",marginBottom:"4px",fontSize:"14px",fontWeight:"500",color:"#374151"},children:"Severity"}),e.jsxs("select",{id:"severity",value:o.severity,onChange:i=>r("severity",i.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",background:"white"},children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"critical",children:"Critical"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"field",style:{display:"block",marginBottom:"4px",fontSize:"14px",fontWeight:"500",color:"#374151"},children:"Field"}),e.jsx("input",{id:"field",type:"text",value:o.field,onChange:i=>r("field",i.target.value),placeholder:"e.g., amount, account_id",style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px"},required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"operator",style:{display:"block",marginBottom:"4px",fontSize:"14px",fontWeight:"500",color:"#374151"},children:"Operator"}),e.jsxs("select",{id:"operator",value:o.operator,onChange:i=>r("operator",i.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",background:"white"},children:[e.jsx("option",{value:"",children:"Select operator"}),e.jsx("option",{value:"gt",children:"Greater Than"}),e.jsx("option",{value:"gte",children:"Greater Than or Equal"}),e.jsx("option",{value:"lt",children:"Less Than"}),e.jsx("option",{value:"lte",children:"Less Than or Equal"}),e.jsx("option",{value:"eq",children:"Equal"}),e.jsx("option",{value:"ne",children:"Not Equal"}),e.jsx("option",{value:"contains",children:"Contains"}),e.jsx("option",{value:"in",children:"In List"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"value",style:{display:"block",marginBottom:"4px",fontSize:"14px",fontWeight:"500",color:"#374151"},children:"Value"}),e.jsx("input",{id:"value",type:"text",value:o.value,onChange:i=>r("value",i.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px"},required:!0})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"escalation_threshold",style:{display:"block",marginBottom:"4px",fontSize:"14px",fontWeight:"500",color:"#374151"},children:"Escalation Threshold"}),e.jsx("input",{id:"escalation_threshold",type:"number",value:o.escalation_threshold,onChange:i=>r("escalation_threshold",parseInt(i.target.value)||0),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px"}})]})}),e.jsxs("div",{style:{display:"flex",gap:"16px",flexWrap:"wrap"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:o.is_active,onChange:i=>r("is_active",i.target.checked)}),e.jsx("span",{style:{fontSize:"14px",color:"#374151"},children:"Active"})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:o.auto_block,onChange:i=>r("auto_block",i.target.checked)}),e.jsx("span",{style:{fontSize:"14px",color:"#374151"},children:"Auto-Block"})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:o.require_approval,onChange:i=>r("require_approval",i.target.checked)}),e.jsx("span",{style:{fontSize:"14px",color:"#374151"},children:"Require Approval"})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:[e.jsx("button",{type:"button",onClick:a,style:{padding:"8px 16px",border:"1px solid #d1d5db",borderRadius:"6px",background:"white",color:"#374151",cursor:"pointer"},children:"Cancel"}),e.jsx("button",{type:"submit",style:{padding:"8px 16px",border:"none",borderRadius:"6px",background:"#1e40af",color:"white",cursor:"pointer"},children:o.id?"Update Rule":"Create Rule"})]})]})};export{B as default};
